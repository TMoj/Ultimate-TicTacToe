<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" http-equiv="X-UA-Compatible" content="ie=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link id="myStyle" rel="stylesheet" type="text/css" href="style.css">
	<style>@import url("style.css") screen;</style>
	<title>Ultimate Tic-Tac-Toe</title>

	<script>

	class o{};class x{};class n{};

	let turn, startingID, c1, c2, c3, c4, c5, c6, c7, c8, c9;
	let end=0;
	let previousField='none';

	function LadyRNG(num){																											//RNG from 1 to x
		var num=Math.floor((Math.random()*num)+1); 
		return num;
	}
	
	function turnChange(){																											 //Changes player
		if(turn===1){
			turn++;
			gameDisplay.innerHTML="<img src=circle.png>Turn: Player 2";
		}else{
			turn--;
			gameDisplay.innerHTML="<img src=cross.png>Turn: Player 1";
		}
	}
	
	function emptyField(f){																					 					 //a DRY code thing
		if(document.getElementById('1'+f).classList.contains('n')===false && 
		document.getElementById('2'+f).classList.contains('n')===false &&
		document.getElementById('3'+f).classList.contains('n')===false && 
		document.getElementById('4'+f).classList.contains('n')===false && 
		document.getElementById('5'+f).classList.contains('n')===false && 
		document.getElementById('6'+f).classList.contains('n')===false && 
		document.getElementById('7'+f).classList.contains('n')===false && 
		document.getElementById('8'+f).classList.contains('n')===false &&
		document.getElementById('9'+f).classList.contains('n')===false){
			return true}
		return false;
	}
	
	function bfContent(bf,f){																									 //a DRY code thing
		if(turn===1){
				document.getElementById(f).classList.add('xw');
				document.getElementById(bf).classList.replace('n','xb');
			}else{
				document.getElementById(f).classList.add('ow');
				document.getElementById(bf).classList.replace('n','ob');
			}
	}

	function checkField(f){																							//Check for field content
		if(f!==0){
			if(document.getElementById(f).classList.contains('xw')===true ||
			document.getElementById(f).classList.contains('ow')===true){
				return false;
			}
		}c1=document.getElementById('1'+f).classList[0];
		c2=document.getElementById('2'+f).classList[0];
		c3=document.getElementById('3'+f).classList[0];
		c4=document.getElementById('4'+f).classList[0];
		c5=document.getElementById('5'+f).classList[0];
		c6=document.getElementById('6'+f).classList[0];
		c7=document.getElementById('7'+f).classList[0];
		c8=document.getElementById('8'+f).classList[0];
		c9=document.getElementById('9'+f).classList[0];
		if(c1!=='n'||c2!=='n'||c3!=='n'||c4!=='n'||c5!=='n'||
			c6!=='n'||c7!=='n'||c8!=='n'||c9!=='n'){
			if(c1===c2 && c2===c3 && c1!=='n' || c4===c5 && c5===c6 && c4!=='n'||
				c7===c8 && c8===c9 && c7!=='n' || c1===c4 && c4===c7 && c4!=='n' ||
				c2===c5 && c5===c8 && c2!=='n' || c3===c6 && c6===c9 && c6!=='n' ||
				c1===c5 && c5===c9 && c5!=='n' || c3===c5 && c5===c7 && c5!=='n') {return true}
			return false
		}
	}

	function winCon(field){																									//Win-Condition check
		if(previousField==='none'){return}
		if(checkField(0)===true){gameEnd('t');return}
		if(emptyField(0)===true){gameEnd('d'); return}
		if(field===document.getElementsByClassName('softlock')[0].id){Softlock(field)}
	}

	function gameEnd(scenario){																											//Game ending
		var winner;end++;
		for (i=1;i<10;i++){
			fieldLock(i);
		}switch (scenario) {
			case 's':
				if(turn===1){winner='Player 2'}else{winner='Player 1'}
				gameDisplay.innerHTML=winner+' won due to the other Player Soflocking the game!';
				break;
			case 't':
				if(turn===1){winner='Player 1'}else{winner='Player 2'}
				gameDisplay.innerHTML=winner+' won the Game!'
				break;
			case 'd':
				gameDisplay.innerHTML="It's a tie! Neither of you won or lost."
				break;
		}
	}

	function smallField(fieldID){													//Change contents of the smaller fields
		if(turn===1){
			document.getElementById(fieldID).classList.replace('n','x');
  	}else{
			document.getElementById(fieldID).classList.replace('n','o');
		}
	}

	function fieldSelect(fieldID){																					//Change active field
		if(previousField==='none'){
			for (let i = 1; i<10; i++) {
				fieldLock([i]);
			}startingID=fieldID.toString().slice(1);
			Softlock();
		}else{
			fieldLock(previousField);
		}var field=fieldID.toString().slice(0,1);
		document.getElementById(field).style.backgroundColor="white";
		document.getElementById(field).style.pointerEvents="auto";
		previousField=field;
	}

	function Softlock(field){																								 //Softlockmanagement
		if(previousField==='none'){
			document.getElementById(startingID).classList.add('softlock'); return;
		}
		if(emptyField(field)===true)		{gameEnd('s');}
	}

	function fieldLock(field){																			 //Locks away the given field
		document.getElementById(field).style.backgroundColor="burlywood";
		if (document.getElementById(field).classList.contains('xw')===true){
		document.getElementById(field).style.backgroundColor='#de9d87';
		} if (document.getElementById(field).classList.contains('ow')===true){
			document.getElementById(field).style.backgroundColor="#dede87";		
		} document.getElementById(field).style.pointerEvents="none";
	}

	function bigField(f){																	//Changes contents of the bigger fields
		var bf=f+'0';
		if(checkField(f)===true){
			bfContent(bf,f);
		}if(emptyField(f)===true){
			var x=turn;	turn=LadyRNG(2);	bfContent(bf,f);	turn=x;
		}
	}

//Seperation Line between "active" and "passive" functions

	document.addEventListener(																						//Initial load function
		"DOMContentLoaded",function(){
			turn=LadyRNG(2);
			turnChange();
			startingID=turn;
		}
	);

	function Turn(fieldID){																												//Turn Function
		var f=fieldID.toString().slice(1);
		var field=fieldID.toString().slice(0,1);
		smallField(fieldID);
		bigField(f);
		winCon(field,f);
		if(end!=0){return}
		fieldSelect(fieldID);
		turnChange();
	}

	</script>
</head>

<body>
	
	<h1 id=test>Ultimate Tic-Tac-Toe</h1><hr>
	<button id='gameDisplay'><img src=empty.png></button><hr>

	<div style="float:left;background-color:burlywood">												<!--left field-->
		<table>
			<tr>
				<td id='1' style="background-color: white;">										<!--top left field-->
					<table>
						<tr>
							<td id=11 class=n><img src="empty.png" onclick=Turn(11)></td>
							<td id=21 class=n><img src="empty.png" onclick=Turn(21)></td>
							<td id=31 class=n><img src="empty.png" onclick=Turn(31)></td>
						</tr>
						<tr>
							<td id=41 class=n><img src="empty.png" onclick=Turn(41)></td>
							<td id=51 class=n><img src="empty.png" onclick=Turn(51)></td>
							<td id=61 class=n><img src="empty.png" onclick=Turn(61)></td>
						</tr>
						<tr>
							<td id=71 class=n><img src="empty.png" onclick=Turn(71)></td>
							<td id=81 class=n><img src="empty.png" onclick=Turn(81)></td>
							<td id=91 class=n><img src="empty.png" onclick=Turn(91)></td>
				</tr></table></td>

				<td id='2' style="background-color: white;">									<!--top middle field-->
					<table>
						<tr>
							<td id=12 class=n><img src="empty.png" onclick=Turn(12)></td>
							<td id=22 class=n><img src="empty.png" onclick=Turn(22)></td>
							<td id=32 class=n><img src="empty.png" onclick=Turn(32)></td>
						</tr>
						<tr>
							<td id=42 class=n><img src="empty.png" onclick=Turn(42)></td>
							<td id=52 class=n><img src="empty.png" onclick=Turn(52)></td>
							<td id=62 class=n><img src="empty.png" onclick=Turn(62)></td>
						</tr>
						<tr>
							<td id=72 class=n><img src="empty.png" onclick=Turn(72)></td>
							<td id=82 class=n><img src="empty.png" onclick=Turn(82)></td>
							<td id=92 class=n><img src="empty.png" onclick=Turn(92)></td>
				</tr></table></td>
				
				<td id='3' style="background-color: white;">									 <!--top right field-->
					<table>
						<tr>
							<td id=13 class=n><img src="empty.png" onclick=Turn(13)></td>
							<td id=23 class=n><img src="empty.png" onclick=Turn(23)></td>
							<td id=33 class=n><img src="empty.png" onclick=Turn(33)></td>
						</tr>
						<tr>
							<td id=43 class=n><img src="empty.png" onclick=Turn(43)></td>
							<td id=53 class=n><img src="empty.png" onclick=Turn(53)></td>
							<td id=63 class=n><img src="empty.png" onclick=Turn(63)></td>
						</tr>
						<tr>
							<td id=73 class=n><img src="empty.png" onclick=Turn(73)></td>
							<td id=83 class=n><img src="empty.png" onclick=Turn(83)></td>
							<td id=93 class=n><img src="empty.png" onclick=Turn(93)></td>
			</tr></table></td></tr>
			
			<tr>
				<td id='4' style="background-color: white;">								 <!--middle left field-->
					<table>
						<tr>
							<td id=14 class=n><img src="empty.png" onclick=Turn(14)></td>
							<td id=24 class=n><img src="empty.png" onclick=Turn(24)></td>
							<td id=34 class=n><img src="empty.png" onclick=Turn(34)></td>
						</tr>
						<tr>
							<td id=44 class=n><img src="empty.png" onclick=Turn(44)></td>
							<td id=54 class=n><img src="empty.png" onclick=Turn(54)></td>
							<td id=64 class=n><img src="empty.png" onclick=Turn(64)></td>
						</tr>
						<tr>
							<td id=74 class=n><img src="empty.png" onclick=Turn(74)></td>
							<td id=84 class=n><img src="empty.png" onclick=Turn(84)></td>
							<td id=94 class=n><img src="empty.png" onclick=Turn(94)></td>
			</tr></table></td>
				
				<td id='5' style="background-color: white;">										 <!--central field-->
					<table>
						<tr>
							<td id=15 class=n><img src="empty.png" onclick=Turn(15)></td>
							<td id=25 class=n><img src="empty.png" onclick=Turn(25)></td>
							<td id=35 class=n><img src="empty.png" onclick=Turn(35)></td>
						</tr>
						<tr>
							<td id=45 class=n><img src="empty.png" onclick=Turn(45)></td>
							<td id=55 class=n><img src="empty.png" onclick=Turn(55)></td>
							<td id=65 class=n><img src="empty.png" onclick=Turn(65)></td>
						</tr>
						<tr>
							<td id=75 class=n><img src="empty.png" onclick=Turn(75)></td>
							<td id=85 class=n><img src="empty.png" onclick=Turn(85)></td>
							<td id=95 class=n><img src="empty.png" onclick=Turn(95)></td>
				</tr></table></td>
				
				<td id='6' style="background-color: white;">								 <!--middle left field-->
					<table>
						<tr>
							<td id=16 class=n><img src="empty.png" onclick=Turn(16)></td>
							<td id=26 class=n><img src="empty.png" onclick=Turn(26)></td>
							<td id=36 class=n><img src="empty.png" onclick=Turn(36)></td>
						</tr>
						<tr>
							<td id=46 class=n><img src="empty.png" onclick=Turn(46)></td>
							<td id=56 class=n><img src="empty.png" onclick=Turn(56)></td>
							<td id=66 class=n><img src="empty.png" onclick=Turn(66)></td>
						</tr>
						<tr>
							<td id=76 class=n><img src="empty.png" onclick=Turn(76)></td>
							<td id=86 class=n><img src="empty.png" onclick=Turn(86)></td>
							<td id=96 class=n><img src="empty.png" onclick=Turn(96)></td>
			</tr></table></td></tr>
			
			<tr>
				<td id='7' style="background-color: white;">									 <!--bottom left field-->
					<table>
						<tr>
							<td id=17 class=n><img src="empty.png" onclick=Turn(17)></td>
							<td id=27 class=n><img src="empty.png" onclick=Turn(27)></td>
							<td id=37 class=n><img src="empty.png" onclick=Turn(37)></td>
						</tr>
						<tr>
							<td id=47 class=n><img src="empty.png" onclick=Turn(47)></td>
							<td id=57 class=n><img src="empty.png" onclick=Turn(57)></td>
							<td id=67 class=n><img src="empty.png" onclick=Turn(67)></td>
						</tr>
						<tr>
							<td id=77 class=n><img src="empty.png" onclick=Turn(77)></td>
							<td id=87 class=n><img src="empty.png" onclick=Turn(87)></td>
							<td id=97 class=n><img src="empty.png" onclick=Turn(97)></td>
				</tr></table></td>
				
				<td id='8' style="background-color: white;">							 <!--bottom center field-->
					<table>
						<tr>
							<td id=18 class=n><img src="empty.png" onclick=Turn(18)></td>
							<td id=28 class=n><img src="empty.png" onclick=Turn(28)></td>
							<td id=38 class=n><img src="empty.png" onclick=Turn(38)></td>
						</tr>
						<tr>
							<td id=48 class=n><img src="empty.png" onclick=Turn(48)></td>
							<td id=58 class=n><img src="empty.png" onclick=Turn(58)></td>
							<td id=68 class=n><img src="empty.png" onclick=Turn(68)></td>
						</tr>
						<tr>
							<td id=78 class=n><img src="empty.png" onclick=Turn(78)></td>
							<td id=88 class=n><img src="empty.png" onclick=Turn(88)></td>
							<td id=98 class=n><img src="empty.png" onclick=Turn(98)></td>
				</tr></table></td>
				
				<td id='9' style="background-color: white;">								<!--bottom right field-->
					<table>
						<tr>
							<td id=19 class=n><img src="empty.png" onclick=Turn(19)></td>
							<td id=29 class=n><img src="empty.png" onclick=Turn(29)></td>
							<td id=39 class=n><img src="empty.png" onclick=Turn(39)></td>
						</tr>
						<tr>
							<td id=49 class=n><img src="empty.png" onclick=Turn(49)></td>
							<td id=59 class=n><img src="empty.png" onclick=Turn(59)></td>
							<td id=69 class=n><img src="empty.png" onclick=Turn(69)></td>
						</tr>
						<tr>
							<td id=79 class=n><img src="empty.png" onclick=Turn(79)></td>
							<td id=89 class=n><img src="empty.png" onclick=Turn(89)></td>
							<td id=99 class=n><img src="empty.png" onclick=Turn(99)></td>
	</tr></table></td></tr></table></div>
	
	<div style="float:right; pointer-events: none ;">													 <!--right field-->
		<table style='background-color: white';>
			<tr>
				<td id=10 class='n'><img src="bempty.png"></td>
				<td id=20 class='n'><img src="bempty.png"></td>
				<td id=30 class='n'><img src="bempty.png"></td>
			</tr>
			<tr>
				<td id=40 class='n'><img src="bempty.png"></td>
				<td id=50 class='n'><img src="bempty.png"></td>
				<td id=60 class='n'><img src="bempty.png"></td>
			</tr>
			<tr>
				<td id=70 class='n'><img src="bempty.png"></td>
				<td id=80 class='n'><img src="bempty.png"></td>
				<td id=90 class='n'><img src="bempty.png"></td>
			</tr>
		</table>
	</div>

	<div style="float:none;margin-left: 32.5%; width: 33.5%;">								<!--other things-->
		<p style="padding:20px; background-color: #eeeeee;">
			Grundlegende Regeln:<br><br>
			-Man darf nur in das linke Feld Zeichen einsetzen.<br>
			-Jeder Spieler kann abwechselnd ein Zeichen setzen.<br>
			-Wenn man eines der linken Felder gewinnt, wird das auf das Rechte übertragen.<br>
			-Um das Spiel zu gewwinen, muss man auf dem Rechten Feld gewinnen.<br>
			-Wer das Spiel Softlocked (Kein Zug mehr möglich), verliert.<br><br>
			Spezielle Regeln:<br><br>
			-Der erste Spielzug der Partie ist frei wählbar.<br>
			-Jeder weitere Zug muss im weißen Feld auf  der linken Seite ausgeführt werden.<br>
			-Welche Fläche man in einem Feld betätigt, bestimmt das neue Feld.<br>
			-Ist eines der linken Felder "gewonnen", kann es immer noch verwendet werden.<br>
			-Der erste Spieler wird per Zufall ausgewählt, man kann frei nach Form wählen.<br>
			-Ist in einem der 9 Felder links ein Gleichstand, entscheidet Lady RNG.<br><br>
			Hinweiße:<br><br>
			-Man kann ungewöhnliche Strategien wesentlich besser anwenden.<br>
			-Dies wurde ausschließlich für Mensch-gegen-Mensch Spiele geschrieben.<br>
			-Der Softlock ist nur in dem Feld möglich, das einen anderen Rahmen hat.
		</p>
		<button onclick=location.reload()>Neustart</button>
	</div>

</body>
</html>
